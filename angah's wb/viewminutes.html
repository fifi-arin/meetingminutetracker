<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="mystyle.css" type="text/css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">

  <title>View Minute</title>
</head>
<body>
  <div id="overlay" onclick="closeSidebar()"></div>

  <header class="top-header">
    <h1>Meeting Minutes Tracker</h1>
  </header>

   <button class="toggle-btn" onclick="toggleSidebar()">☰</button>

 <aside class="sidebar" id="sidebar">

  <div class="sidebar-header">
      <img src="logo.png" alt="Logo" class="sidebar-logo">
      <span class="sidebar-title">Meeting Minute Tracker</span>
  </div>


<!---Sidebar Search Boostrap--->

  <div class="sidebar-search">
    <i class="bi bi-search"></i>
    <input type="text" placeholder="Search..." />
  </div>


  <!--Sidebar link form-->

  <div class="sidebar-menu">
  <a href="index.html" class="sidebar-link active">
    <i class="bi bi-house-door"></i>
    <span>Home</span>
  </a>

<a href="dashboard.html" class="sidebar-link">
    <i class="bi bi-speedometer2"></i>
    <span>Dashboard</span>
  </a>

  <div class="dropdown">
    <button class="dropdown-toggle" type="button"> 
    <i class="bi bi-plus-circle"></i>
    <span>Add Minutes</span>
    <i class="bi bi-chevron-down ms-auto"></i>
  </button>
    <div class="dropdown-content">
      <div class="subgroup">
        <strong>Minit Mesyuarat</strong>
        <a href="jawatankuasa.html">⚬ Jawatankuasa Kewangan</a>
        <a href="mesyuaratbulanan.html">⚬ Mesyuarat Bulanan</a>
        <a href="mesyuaratk.html">⚬ Mesyuarat Khas</a>
        <a href="mpp.html">⚬ Majlis Perwakilan Pelajar</a>
        <a href="adnew1.html">⚬ Add New</a>
      </div>

      <div class="subgroup">
        <strong>Pelantikan / Projek / Bajet</strong>
        <a href="pj.html">⚬ Pelantikan Jawatankuasa</a>
        <a href="pej.html">⚬ Perancangan Projek</a>
        <a href="perj.html">⚬ Permohonan Bajet</a>
        <a href="hep.html">⚬ Hal Ehwal Pengurusan</a>
        <a href="adnew2.html">⚬ Add New</a>
      </div>

      <div class="subgroup">
        <strong>Tugas - Tugas Lain</strong>
        <a href="ak.html">⚬ Aktiviti Ko-Kurikulum</a>
        <a href="tk.html">⚬ Tugas Khas</a>
        <a href="pak.html">⚬ Perbincangan Akademik</a>
        <a href="hap.html">⚬ Hal Pentadbiran</a>
        <a href="adnew3.html">⚬ Add New</a>
      </div>
    </div>
  </div>

  <a href="viewminutes.html" class="sidebar-link">
  <i class="bi bi-folder"></i>
  <span>View Minutes</span>
</a>

<div class="sidebar-bottom">

<div class="sidebar-user">
  <i class="bi bi-person-circle user-icon"></i>
  <div class="user-info">
    <strong>Erin</strong>
    <small>Administrator</small>
  </div>
</div>

<div class="sidebar-actions"> 
<button id="darkModeToggle" class="icon-btn" title="Toggle dark mode">
      <i id="darkModeIcon" class="bi bi-moon-stars-fill"></i>
    </button>

  <a href="login.html">
 <button class="icon-btn logout-btn" id="logout-btn">
      <i class="bi bi-box-arrow-right"></i>
    </button>
  </a>
</div>
</div>
</aside>

<h3>View All Meeting Minutes</h3> 

<div class="form-card"> 
<div class="search-bar">
  <input type="text" id="searchInput" placeholder="Search by title, category, or date..." onkeyup="filterTable()" />
</div>

<div class="filter-group">
  <label>Category: 
    <select id="categoryFilter" onchange="filterTable()">
      <option value="">All</option>
      <option value="Minit Mesyuarat">Minit Mesyuarat</option>
      <option value="Pelantikan / Projek / Bajet">Pelantikan / Projek / Bajet</option>
      <option value="Tugas - Tugas Lain">Tugas - Tugas Lain</option>
    </select>
  </label>
</div>

<table id="minutesTable">
  <thead>
    <center>
      <tr>
      <th>Bil</th>
      <th>Category</th>
      <th>Title</th>
      <th>Date</th>
      <th>Details</th>
      <th>Document</th>
      <th>Actions</th>
    </tr>
  </center>
  </thead>
  <tbody></tbody>
</table>

</div>



<footer style="background-color:#291660; color:white; font-family:Arial, sans-serif; padding:30px 20px; font-size:12px;">

  <div style="display:flex; justify-content:space-between; flex-wrap:wrap; gap:30px; max-width:1000px; margin:auto;">

    <div style="flex:1; min-width:250px;">
      <h3 style="margin-bottom:8px;"><strong>About Us</strong></h3>
      <p style="line-height:1.5;">
        At Meetlyst, we believe that every great decision starts with clarity. Designed as a modern and intuitive meeting minutes tracker, Meetlyst helps teams capture discussions, document decisions, and stay aligned without the clutter and confusion that often follow meetings.
      </p>
    </div>

    <div style="flex:1; min-width:200px;">
      <h3 style="margin-bottom:8px;">Connect With Us</h3>
      <p style="line-height:1.9;">

        <a href="https://instagram.com" style="color:white; text-decoration:none;">
          <i class="bi bi-instagram"></i> Instagram
        </a><br>

        <a href="https://facebook.com" style="color:white; text-decoration:none;">
          <i class="bi bi-facebook"></i> Facebook
        </a>
      </p>
    </div>

    <div style="flex:1; min-width:200px;">
      <h3 style="margin-bottom:8px;">Contact Us</h3>
      <ul style="list-style:none; padding:0; line-height:2;">
        <li>
          <a href="contactus.html" style="color:white; text-decoration:none;">
            <i class="bi bi-envelope"></i> Email Us
          </a>
        </li>
        <li>
          <a href="tel:+123456789" style="color:white; text-decoration:none;">
            <i class="bi bi-telephone"></i> Call Us
          </a>
        </li>
      </ul>
    </div>

  </div>

  <p style="text-align:center; margin-top:25px; opacity:0.8;">
    © 2025 Meetlyst. All Rights Reserved.
  </p>

</footer>


<script>
// Sidebar toggle
function toggleSidebar() {
  const sidebar = document.getElementById('sidebar');
  const overlay = document.getElementById('overlay');
  sidebar.classList.toggle('open');
  overlay.classList.toggle('active');
}

function closeSidebar() {
  document.getElementById('sidebar').classList.remove('open');
  document.getElementById('overlay').classList.remove('active');
}

//Dark Mode
document.addEventListener("DOMContentLoaded", () => {
  const darkModeToggle = document.getElementById("darkModeToggle");
  const darkModeIcon = document.getElementById("darkModeIcon");
  const htmlElement = document.documentElement;

  // Load saved theme
  const savedTheme = localStorage.getItem("theme") || "light";
  htmlElement.setAttribute("data-bs-theme", savedTheme);
  updateIcon(savedTheme);

  // Toggle theme on click
  darkModeToggle.addEventListener("click", () => {
    const currentTheme = htmlElement.getAttribute("data-bs-theme");
    const newTheme = currentTheme === "light" ? "dark" : "light";

    htmlElement.setAttribute("data-bs-theme", newTheme);
    localStorage.setItem("theme", newTheme);
    updateIcon(newTheme);
  });

  function updateIcon(theme) {
    if (theme === "dark") {
      // Dark screen → show SUN
      darkModeIcon.className = "bi bi-sun-fill";
    } else {
      // Light screen → show MOON
      darkModeIcon.className = "bi bi-moon-stars-fill";
    }
  }
});
//dropdown content hover 
document.querySelectorAll('.dropdown').forEach(dropdown => {
  const toggle = dropdown.querySelector('.dropdown-toggle');
  const menu = dropdown.querySelector('.dropdown-content');
  const sidebar = document.getElementById('sidebar');

  if (!toggle || !menu) return;

  function openMenu() {
    const toggleRect = toggle.getBoundingClientRect();
    const sidebarRect = sidebar.getBoundingClientRect();

    let left = sidebarRect.right + 10;
    let top = toggleRect.top;

    const maxHeight = window.innerHeight * 0.8;
    menu.style.maxHeight = maxHeight + 'px';

    // keep inside viewport vertically
    if (top + menu.offsetHeight > window.innerHeight - 8) {
      top = window.innerHeight - menu.offsetHeight - 8;
    }
    if (top < 8) top = 8;

    menu.style.left = left + 'px';
    menu.style.top = top + 'px';

    menu.classList.add('show');
  }

  function closeMenu() {
    menu.classList.remove('show');
  }

  // ✅ DESKTOP = hover
  toggle.addEventListener('mouseenter', () => {
    if (window.innerWidth > 768) openMenu();
  });

  menu.addEventListener('mouseenter', () => {
    if (window.innerWidth > 768) openMenu();
  });

  toggle.addEventListener('mouseleave', () => {
    if (window.innerWidth > 768) {
      setTimeout(() => {
        if (!menu.matches(':hover')) closeMenu();
      }, 100);
    }
  });

  menu.addEventListener('mouseleave', () => {
    if (window.innerWidth > 768) closeMenu();
  });

  // ✅ MOBILE = tap → SAME POSITION
  toggle.addEventListener('click', e => {
    e.preventDefault();
    menu.classList.contains('show') ? closeMenu() : openMenu();
  });

  // click outside → close
  document.addEventListener('click', e => {
    if (!dropdown.contains(e.target) && !menu.contains(e.target)) {
      closeMenu();
    }
  });

  // reposition on scroll / resize
  window.addEventListener('resize', () => {
    if (menu.classList.contains('show')) openMenu();
  });

  window.addEventListener('scroll', () => {
    if (menu.classList.contains('show')) openMenu();
  }, { passive: true });
});


//view minutes functions//

function loadMinutesData() {
      const allData = JSON.parse(localStorage.getItem("minutesData")) || [];
      const data = allData;

      const tbody = document.querySelector("#minutesTable tbody");
      tbody.innerHTML = "";
      data.forEach((item, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${index + 1}</td>
          <td>${item.type}</td>
          <td contenteditable="true">${item.title}</td>
          <td contenteditable="true">${item.date}</td>
          <td contenteditable="true">${item.details}</td>
          <td>
        ${item.file?.data
          ? `<a href="${item.file.data}" download="${item.file.name}">${item.file.name}</a>`
          : 'No file'}
      </td>

          <td class="actions">
            <button onclick="deleteEntry(${index})">Delete</button>
            <button onclick="saveEdited(${index}, this)">Save</button>
          </td>`;
        tbody.appendChild(row);
      });
    }

    function deleteEntry(index) {
      const allData = JSON.parse(localStorage.getItem("minutesData")) || [];
      const filteredData = allData.filter(item => item.type !== "Lain-Lain");
      const itemToDelete = filteredData[index];
      const originalIndex = allData.findIndex(item =>
        item.title === itemToDelete.title &&
        item.date === itemToDelete.date &&
        item.details === itemToDelete.details &&
        item.type === itemToDelete.type
      );
      if (originalIndex !== -1) {
        allData.splice(originalIndex, 1);
        localStorage.setItem("minutesData", JSON.stringify(allData));
        loadMinutesData();
      }
    }

    function saveEdited(index, btn) {
      const row = btn.closest("tr");
      const allData = JSON.parse(localStorage.getItem("minutesData")) || [];
      const filteredData = allData.filter(item => item.type !== "Lain-Lain");
      const itemToEdit = filteredData[index];
      const originalIndex = allData.findIndex(item =>
        item.title === itemToEdit.title &&
        item.date === itemToEdit.date &&
        item.details === itemToEdit.details &&
        item.type === itemToEdit.type
      );
      if (originalIndex !== -1) {
        allData[originalIndex].title = row.cells[2].innerText;
        allData[originalIndex].date = row.cells[3].innerText;
        allData[originalIndex].details = row.cells[4].innerText;
        localStorage.setItem("minutesData", JSON.stringify(allData));
        alert("Changes saved.");
      }
    }

    function filterTable() {
      const search = document.getElementById("searchInput").value.toLowerCase();
      const category = document.getElementById("categoryFilter").value.toLowerCase();
      const rows = document.querySelectorAll("#minutesTable tbody tr");

      rows.forEach(row => {
        const [_, type, title, date] = row.children;
        const matchSearch =
          title.innerText.toLowerCase().includes(search) ||
          date.innerText.toLowerCase().includes(search) ||
          type.innerText.toLowerCase().includes(search);
        const matchCategory = category ? type.innerText.toLowerCase().includes(category) : true;
        row.style.display = matchSearch && matchCategory ? "" : "none";
      });
    }

    document.addEventListener("DOMContentLoaded", loadMinutesData);
  </script>
</body>
</html>